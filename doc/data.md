数据库设计简介
本文/教程将教授关系数据库设计的基础，并说明如何进行良好的数据库设计。这是一个很长的文本，但我们建议阅读这一切。设计数据库实际上相当容易，但有一些规则需要遵守。重要的是要知道这些规则是什么，但更重要的是知道为什么这些规则存在，否则你会倾向于犯错误！

标准化使数据模型更加灵活，并且使处理数据更加容易。请花时间学习这些规则并应用它们！本文中使用的数据库是使用我们的数据库设计和建模工具DeZign为数据库设计的。

良好的数据库设计从要包括在数据库中的数据列表以及您希望以后能够对数据库进行哪些操作开始。这一切都可以用您自己的语言编写，无需任何 SQL。在这个阶段，你必须尽量不思考表或列，但只是想想："我需要知道什么？不要掉以轻心，因为如果你后来发现你忘了什么，通常你需要从头做起。将事物添加到数据库中主要是大量的工作。

识别实体
保存在数据库中的信息类型称为"实体"。这些实体有四种：人员、事物、事件和位置。您想要放入数据库中的所有内容都适合这些类别之一。如果要包含的信息不适合这些类别，则它可能不是实体，而是实体的属性，即属性。

为了澄清本文中给出的信息，我们将使用一个示例。假设您正在为一家商店创建一个网站，您必须处理哪些信息？在商店里，你向顾客推销你的产品。"商店"是一个位置;"销售"是一个事件;"产品"是东西;"客户"是人。这些都是需要包含在数据库中的实体。

但是在销售产品时还发生了什么其他事情呢？一位顾客走进商店，走近供应商，问一个问题并得到答案。"供应商"也参与其中，因为供应商是人，我们需要一个供应商实体。

Entities: types of information
图1：实体：信息类型。
识别关系
下一步是确定实体之间的关系，并确定每个关系的主要性。关系是实体之间的连接，就像在现实世界中一样：一个实体如何处理另一个实体，它们之间有什么关系？例如，客户购买产品，产品销售给客户，销售包括产品，销售发生在商店。

基数显示关系的一侧有多少属于关系的另一侧。首先，您需要说明每个关系，一方的多少正好属于另一方的一方。例如：有多少客户属于 1 个销售？有多少销售属于 1 个客户？一家商店有多少销售？

您将得到这样的列表：（请注意，"产品"代表一种产品类型，而不是产品发生）

客户 -- > 销售;1 个客户可以多次购买
销售 -- > 客户;1 个销售始终由 1 个客户进行
客户 -- --> 产品;1 个客户可以购买多个产品
产品 -- --> 客户;多个客户可购买 1 种产品
顾客 -- -- > 商店;1 名客户可以在多个商店购买
商店 -- > 客户，1 家商店可以接待多个客户
商店 -- -- > 产品;在 1 家商店有多个产品
产品 -- -- > 商店;1 种产品（类型）可以在多个商店销售
商店 -- -- > 销售;在一家商店多个销售可以我
销售 -- --> 商店;1 个销售只能在 1 家商店进行
产品 -- -- > 销售;1 种产品（类型）可多次销售购买
销售 -- > 产品;多个产品可以存在 1 个销售
我们提到过所有的关系吗？有四个实体，每个实体与所有其他实体都有关系，因此每个实体必须有三个关系，并且也会在关系的左端出现三次。上面提到了12个关系，即4*3，因此我们可以得出结论，所有关系都提到了。

现在，我们将将数据放在一起，以查找整个关系的主要性。为此，我们将起草每个关系的主要。为了便于这样做，我们将调整一点表示法，同时注意"向后"关系：

客户 -- > 销售;1 个客户可以多次购买
销售 -- > 客户;1 个销售始终由 1 个客户进行
第二个关系，我们将扭转，所以它具有相同的实体顺序作为第一个。请注意，现在面对相反的方式箭头！

客户 <-- 销售;1 个销售始终由 1 个客户进行
基数有四种类型：一对一、一对多、多对一和多对多。在数据库设计中，这指示为：1：1、1：N、M：1 和 M：N。要找到正确的指示，只需离开"1"。如果左侧有"多"，则用"M"表示，右侧有"多"，则用"N"表示。

客户 -- > 销售;1 个客户可以多次购买;1：N.
客户 <-- 销售;1 销售始终由 1 个客户在当时进行;1:1.
可以通过为左侧和右侧分配最大值来计算真正的基数，而"N"或"M"大于"1"。在此例中，在这两种情况下，左侧都有一个"1"。右侧有一个"N"和一个"1"，"N"是最大的值。因此，总基数为"1：N"。客户可以进行多个"销售"，但每个"销售"只有一个客户。

如果我们也这样做的其他关系，我们将得到：

客户 -- > 销售;--> 1：N
客户 -- --> 产品;-->M：N
顾客 -- -- > 商店;-->M：N
销售 -- > 产品;-->M：N
商店 -- -- > 销售;--> 1：N
商店 -- -- > 产品;-->M：N
因此，我们有两个"一对多"关系和四个"多对多"关系。

relationships between the entities
图 2：实体之间的关系。
实体之间可能有相互依赖关系。这意味着如果另一个项不存在，则一个项无法存在。例如，如果没有客户，则无法进行销售;如果没有产品，则无法进行销售。

销售关系 --> 客户和销售 -- > 产品是强制性的，但情况并非如此。客户可以不销售就存在，产品也可以存在而不销售。这对下一步非常重要。

递归关系
有时，实体会回指自身。例如，考虑一个工作层次结构：员工有一个老板;老板也是雇员实体"员工"的属性"boss"是指实体"员工"。

在 ERD（请参阅下一章）中，这种类型的关系是一行从实体中消失，并返回同一个实体的一个很好的循环。

冗余关系
有时，在模型中，你会得到一个"冗余关系"。这些关系已经由其他关系指示，虽然不是直接指示的。

在我们的示例中，客户和产品之间有直接的关系。但是，从客户到销售，从销售到产品，也有关系，因此间接地，客户和产品之间已经通过销售建立了关系。"客户 <----> 产品"的关系是两次，因此其中一个是多余的。在这种情况下，产品只能通过销售购买，因此可以删除"客户 <----> 产品"的关系。模型将看起来像这样：

redundant relationships
Figure 3: Relationships between the entities.
解决多对多关系
多对多关系 （M：N） 在数据库中是无法直接实现的。M：N 关系表示，一个表中的多个记录属于另一个表中的多个记录。需要保存这些记录的地方，解决方案是将关系拆分为两个一对多关系。

这可以通过创建一个位于相关实体之间的新实体来完成。在我们的示例中，销售和产品之间存在多对多关系。这可以通过创建新实体来解决：销售产品。此实体与 Sales 具有多对一关系，与产品有多对一关系。在逻辑模型中，这称为关联实体，在物理数据库术语中，这称为链接表、交点表或交汇点表。

many to many relationship
associative entity
图 4：通过关联实体实现多到多关系。
在示例中，需要解决两种多对多关系："产品 <----> 销售"和"产品 <----> 商店"。对于这两种情况，都需要创建一个新实体，但该实体是什么？

对于产品 <----> 销售关系，每次销售都包含更多产品。关系显示销售内容。换句话说，它给出了有关销售的细节。因此，实体称为"销售详细信息"。您还可以命名它"销售的产品"。

产品 <----> 商店关系显示哪些产品在哪些商店（也称为"库存"）中可用。我们的模型现在看起来像这样：

data model with link tables stock and sales_details
图 5：带链接表的型号库存Sales_details。
